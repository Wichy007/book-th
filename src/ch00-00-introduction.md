# บทนำ

> Note: เวอร์ชันของหนังสือเล่มนี้ เป็นเวอร์ชันเดียวกันกับ [The Rust Programming
> Language][nsprust] ซึ่งเปิดให้พิมพ์หรือดาวน์โหลดในรูปแบบของ ebook ได้ที่ [No Starch
> Press][nsp].

[nsprust]: https://nostarch.com/rust-programming-language-3rd-edition
[nsp]: https://nostarch.com/

ยินดีต้อนรับสู่ _Rust Programming Language_, เนื้อหาในส่วนนี้เป็นเนื้อหาเบื้องต้นของหนังสือเล่มนี้เกี่ยวกับภาษา Rust
Rust นั้นช่วยให้เราสามารถเขียน software ที่รวดเร็ว และน่าเชื่อถือได้มากขึ้น

ในการออกแบบภาษาโปรแกรมมักต้องเลือกระหว่าง ความสะดวกในการใช้งานของผู้พัฒนา (High-level) หรือความสามารถในการจัดการกับ hardware (Low-level) ซึ่ง Rust นั้นสามารถข้ามผ่านความท้าทายนี้มาได้ โดยคงไว้ซึ่งความสามารถในการจัดการกับ hardware ที่ดี (เช่น การจัดการการใช้งาน memory) โดยไม่ต้องเผชิญกับความยุ่งยากในการพัฒนา เหมือนอย่างภาษา Low-level อื่นๆที่เคยมีมา

## Rust เหมาะสำหรับใคร

Rust เป็นภาษาที่เหมาะกับผู้คนหลายกลุ่ม ด้วยหลากหลายเหตุผลเราลองมาดูกันถึงเหตุผลสำคัญที่ว่า ทำไมภาษานี้ถึงเหมาะสม

### ทีมนักพัฒนา

Rust ได้รับการพิสูจน์มาว่าเหมาะสมกับการทำงานเป็นทีม ที่ประกอบด้วยนักพัฒนาที่มีความเชี่ยวชาญ หรือความเข้าใจต่อภาษาที่หลากหลาย
ภาษา Low-level มักเกิด bug อยู่เรื่อยๆ ซึ่งในภาษาเหล่านั้นก็ป้องกันการเกิด bug ด้วยการทดสอบอย่างหนัก หรือการตรวจสอบ code ด้วยนักพัฒนาที่มีประสบการณ์มากกว่า
แต่ใน Rust นั้น compiler ของภาษาจะทำหน้าที่เป็นเหมือนผู้รักษาประตูของ code ผ่านการ compile เพื่อป้องกัน bug ที่ซ่อนอยู่ภายใน เพราะฉะนั้นด้วยการทำงานควบคู่ไปด้วยของ compiler จึงทำให้ ทีมนักพัฒนาสามารถมุ่งความสนใจในการพัฒนา software และออกแบบ logic ภายใน program แทนที่จะไปสนใจ bug ที่น่าปวดหัว

Rust ยังมีเครื่องมือเพื่อนักพัฒนาที่ทันสมัยในการใช้งานในโลกของการเขียน program ด้วย:

- Cargo เป็นตัวคอยจัดการเรื่อง build code, compile code และทำให้ การจัดการ dependency เป็นไปได้อย่างราบรื่น และสม่ำเสมอในทุกๆที่ ที่ใช้ Rust 
* `rustfmt` เป็นตัวคอยตรวจสอบความสม่ำเสมอของรูปแบบการเขียน code ระหว่างนักพัฒนาด้วยกันเอง
* The Rust Language Server เป็นพลังในการช่วย Integrated Development Environment (IDE) ในการทำ code completion และการแจ้งเตือน error messages ในแต่ละบรรทัด 

ด้วยการใช้งานเครื่องมือเหล่านี้ในสภาพแวดล้อมของ Rust นักพัฒนาจึงสามารถสนใจเพียงการพัฒนา program ตาม business ได้ (system-level)

### นักเรียน

Rust เหมาะสำหรับนักเรียน ผู้ซึ่งสนใจจะทำความเข้าใจเกี่ยวกับเป้าหมายของ system
การเลือกใช้ Rust ทำให้หลายคนสามารถเรียนรู้ และเข้าใจการทำงานบางอย่าง เช่นการทำงานของระบบในเบื้องลึกได้
อีกทั้งชุมชนผู้พัฒนา Rust ยังยินดีต้อนรับ และยินดีที่จะตอบคำถามของผู้มาใหม่ทุกคนอีกด้วย
ทีมพัฒนาของ Rust ต้องการสร้างสภาพแวดล้อมที่เข้าถึงได้อย่างง่ายดาย จากผู้ใช้งาน Rust ทุกคน โดยเฉพาะอย่างยิ่งกับผู้เริ่มต้นใช้งาน Rust 

### บริษัท

หลายบริษัท ทั้งขนาดเล็กและขนาดใหญ่ต่างเลือกใช้ Rust ที่ production หลายๆส่วน เช่น การสร้าง command line tools, การทำ web service หลายๆระบบ, เครื่องมือสำหรับ DevOps, โปรแกรมที่ติดตั้งในเครื่องจักร, การวิเคราะห์ภาพและเสียง และแปลงเป็นสื่อแบบต่างๆ, Cryptocurrencies, การทำเครื่องมือช่วยค้นหา (search engine), IoT, ML และถูกใช้เป็นส่วนใหญ่ในระบบของ Firefox web browser ชื่อดังที่ใครหลายคนรู้จักเป็นอย่างดี

### นักพัฒนา Open Source

Rust ยังเหมาะสำหรับผู้ที่ต้องการมีส่วนร่วมในการพัฒนาชุมชนของ Rust ด้วยเช่นกัน เราชื่นชอบอย่างมากที่ทุกคนจะช่วยกันดูและ พัฒนาชุมชนนี้ผ่านการสร้าง developer tools และ libraries โดยใช้ Rust

### ผู้คนผู้ซึ่งให้ความสำคัญกับความเร็ว และความเสถียร

Rust เป็นภาษาที่สำหรับผู้ที่กระหายในความเร็ว และความเสถียรจากตัวภาษา
"ความเร็ว" ที่ผมหมายถึง คือความเร็วของ program ที่พัฒนาจาก Rust รวมถึงความเร็วของ developer เมื่อเขียน Rust ด้วยเช่นกัน เนื่องจาก compiler ของ rust จะทำหน้าที่ในการตรวจสอบยืนยันความถูกต้อง และเสถียรภาพของ code ชุดนั้น แม้ว่าจะมีการเพิ่มเติม feature ใหม่ หรือ refactoring ก็ตาม ซึ่งแตกต่างจาก legacy code ที่ไม่ได้เขียนด้วย Rust ที่มี compiler คอยจัดการสิ่งนี้ให้ ทำให้ตัว code มักมีความเปราะบาง และไม่เสถียรจนผู้พัฒนาไม่กล้าที่จะแก้ไข code ในส่วนนั้น

ด้วยความมุ่งมั่นที่จะสร้างสภาพแวดล้อมเพื่อการออกแบบในเชิง abstraction แบบที่ต้นทุนต่ำที่สุด หรือถึงไม่มีต้นทุนเลย Rust จึงให้ความสำคัญกับการ compile code ที่ระดับสูง (high-level) ไปเป็น low-level ให้เร็วที่สุดเท่าที่จะเป็นไปได้ กล่าวคือ Rust มุ่งเน้นทั้งการออกแบบ และพัฒนา code ที่ปลอดภัย และคงความเร็วไว้ได้ในเวลาเดียวกัน

สุดท้ายนี้ Rust ยังคงมุ่งมั้นในการพัฒนาเพื่อรองรับผู้ใช้งานอีกมากมายในอนาคต กลุ่มผู้ใช้งานที่กล่าวถึงข้างต้นเป็นเพียงกลุ่มตัวอย่างเท่านั้น Rust พยายามในการกำจัด trade off ที่เราเหล่า developer ต้องเลือกอยู่เสมอ เช่น ต้องเลือกระหว่าง ความปลอดภัย กับความเร็วในการสร้าง product หรือความเร็วของภาษา กับความมง่ายในการเขียนภาษานั้นๆ

ลองใช้ Rust ดู แล้วคุณจะรู้ว่านี้คือตัวเลือกที่ตอบโจทย์สำหรับคุณ

## หนังสือเล่มนี้เหมาะกับใคร

หนังสือเล่มนี้เขียนบนพื้นฐานที่ว่าคุณเคยเขียน program ด้วยภาษาใดก็ได้มาอย่างน้อยหนึ่งภาษามาก่อน
หนังสือเล่มนี้จึงไม่ได้ลงลึกในส่วนของเนื้อหาที่แสดงถึงวิธีการคิดก่อนที่เราจะลงมือเขียน code หรือ การเขียน code คืออะไร
เพราะฉะนั้น หากคุณเป็นผู้เริ่มต้นสำหรับการเขียนโค้ด หนังสือเล่มนี้อาจจะยากเกินไปสำหรับคุณ จะดีกว่าหากคุณเริ่มต้นด้วยการเรียนรู้วิธีการเขียน code ก่อนเป็นอันดับแรก

## หนังสือเล่มนี้อ่านอย่างไรดี

โดยปกติ หนังสือเล่มนี้คาดเดาว่าการอ่านของผู้อ่านทุกคนจะอ่านจากด้านหน้าของหนังสือสู่ด้านหลังตามลำดับ
ดังนั้นในบทหลังจึงมีการใช้เนื้อหาจากบทก่อนหน้า และเสริมเพิ่มเติมรายละเอียด หรือแนวคิดบางอย่างเข้าไปมากขึ้น โดยในบทแรกๆเราจะยังไม่มีการเจาะลึกในรายละเอียดของหัวข้อนั้นมาก แต่จะถูกพูดถึงมากขึ้นในบทต่อๆไป

ในหนังสือเล่มนี้คุณจะได้เจอกับเนื้อหา 2 รูปแบบ แบ่งออกเป็น บททฤษฎีแนวคิด และบทที่ให้ทำ project ในส่วนของบทที่เป็น project แน่นอนว่าเราจะใช้ Rust และลงมือเขียน program เล็กๆไปพร้อมกันตามเนื้อหาของบทนั้น โดยบทที่เป็น project นั้นมีเพียงบทที่ 2, 12 และ 21 เท่านั้น ส่วนบทที่เหลือเป็นทฤษฎีแนวคิดทั้งหมด

**บทที่ 1** จะเน้นเรื่องการอธิบายการลง Rust ในเครื่อง, เริ่มต้นการเขียน “Hello, world!” ด้วย Rust, การใช้ cargo ซึ่งเป็นตัวจัดการ package และ build tool ของ Rust 

**บทที่ 2** คือบท project ที่เราจะเริ่มต้นเขียน Rust กัน โดยเราจะเรียนรู้ในแนวคิดต่างๆของ Rust แบบผิวเผิน ผ่าน project เกมส์ทายตัวเลข ก่อนจะได้ลงลึกถึงรายละเอียดของหัวข้อต่างๆในบทต่อๆไป หากคุณต้องการเรียนรู้จากการลงมือทำ บทนี้จะเป็นบทที่เหมาะมากให้คุณได้ลอง แต่ในตอนแรกคุณสามารถข้ามบทนี้ไปก่อนก็ได้เช่นกัน

**บทที่ 3** เรียนรู้ feature ของ Rust ที่มีคล้ายกับภาษาอื่นๆก่อนที่จะไปสู่บทต่อไป
มาถึงจุดนี้ถ้าคุณอยากทบทวนสิ่งที่ได้เรียนรู้มาการกลับไปที่ **บทที่ 2** ก็เป็นตัวเลือกที่ดีมากที่จะใช้ project ในบทที่ 2 เพื่อฝึกฝนสิ่งที่เรียนมาด้วยการลงมือทำ

**บทที่ 4** ในบทนี้เราจะเรียนรู้ feature พิเศษของ Rust นั้นก็คือ ownership นั่นเอง 

**บทที่ 5** มาพูดถึง struct และ methods ของ Rust

**บทที่ 6** ครอบคลุมเรื่อง enum, `match` expression และ การควบคุม flow ด้วย `if let` และ `let...else` คุณสามารถใช้ struct และ enum เพื่อสร้าง custom type ได้ใน Rust

**บทที่ 7** มาเรียนรู้เกี่ยวกับการจัดการ module และ กฏความเป็นส่วนตัวเพื่อจัดการโครงสร้าง code ของคุณ รวมถึงการสร้าง API สาธารณะ

**บทที่ 8** พูดคุยกันถึงเรื่อง data structures ที่มีมาให้ใน Rust เช่น vectors, strings และ hash maps

**บทที่ 9** รู้ถึงวัฒนธรรม และเทคนิคในการจัดการ error ของ Rust

**บทที่ 10** ลงลึกไปในแนวคิดของ generics type, traits และ lifetimes ที่จะให้พลังคุณในการจัดการ type ที่หลากหลายมากขึ้น

**บทที่ 11** ทั้งบทคือเรื่องการ testing program ขอเราแม้ว่า Rust จะมี compiler ที่ยอดเยี่ยม แต่การยืนยันความถูกต้องของ logic ก็เป็นสิ่งที่จำเป็น

**บทที่ 12** เราจะมาสร้าง function ที่มีความสามารถคล้าย `grep` ซึ่งเป็นคำสั่งจาก command line ที่ใช้สำหรับค้นหาคำในไฟล์ ซึ่งในการทำ project นี้จำเป็นต้องใช้ความรู้ของบทก่อนๆอย่างมากทีเดียว

**บทที่ 13** สำรวจแนวคิดแบบ functional programming ผ่าน closures และ iterators ใน Rust

**บทที่ 14** เรามาเรียนรู้เกี่ยวกับ cargo ให้ลึกยิ่งขึ้น และพูดถึงวิธีที่ดีที่สุดในการสร้าง library ของตัวคุณเอง และแชร์ให้แก่ผู้อื่น

**บทที่ 15** พูดคุยถึงแนวคิด smart pointers ซึ่งเป็นของที่มีมาให้อยู่แล้วใน Rust ไม่ต้องลงเพิ่มเติม และแนวคิดของ traits ที่ส่งเสริมการทำงานของ smart pointers

**บทที่ 16** มาพูดกันถึงเรื่องรูปแบบของ concurrent programming รูปแบบต่างๆ และทำไม Rust ถึงช่วยให้คุณทำ multiple threads ได้อย่างไร้ความกังวล

**บทที่ 17** ต่อยอดการเรียนรู้ด้วยการสำรวจ async/await, tasks, futures และ streams ซึ่งทำงานผ่านการจัดการ concurrency ที่เบาไม่กินเนื้อที่เยอะ

**บทที่ 18** เปรียบเทียบแนวทางการเขียน Rust กับแนวคิดแบบ OOP ที่เราคุ้นเคยว่าแตกต่างกันอย่างไรบ้าง

**บทที่ 19** คือการอ้างอิงถึงวิธีการเขียน code ด้วย Rust ที่ทรงพลังผ่านการทำ pattern matching 

**บทที่ 20** รวบรวมเนื้อหาขั้นสูงแบบเจาะลึกเรื่องต่างๆของ Rust เอาไว้เช่น unsafe Rust, macros, and
more about lifetimes, traits, types, functions, และ closures.

**บทที่ 21** เราจะมาทำ project เพื่อจบการเรียนรู้ของ Rust ที่ได้จากหนังสือเล่มนี้กันด้วยการสร้าง multithreaded web server!

สุดท้าย คำศัพท์และ keywordต่างๆ ที่จำเป็นของ Rust จะอยู่ใน **Appendix A** ส่วนใน **Appendix B** จะเก็บสัญลักษณ์ operator ต่างๆไว้, **Appendix C** เก้บตัวแปรต่างๆของ standard library ไว้, **Appendix D** มีแนะนำเครื่องมือสำหรับการพัฒนา Rust, **Appendix E** อธิบายเกี่ยวกับเวอร์ชันของ Rust, **Appendix F** คุณจะพบกับการแปลหนังสือเล่มนี้ในภาษาต่างๆ **Appendix G** เราจะบอกคุณว่า Rust สร้างมาอย่างไร และอะไรคือ nightly Rusy 

โดยสรุป ไม่มีวิธีที่ถูกหรือผิดในการอ่านหนังสือเล่มนี้ ถ้าคุณอยากจะข้ามบทไหนก็สามารถทำได้ เลือกวิธีที่เหมาะกับคุณได้เลย แต่หากมีข้อสงสัย หรือจุดที่ไม่เข้าใจอย่าลืมย้อนกลับมาบทก่อนหน้า มันจะช่วยคุณได้

<span id="ferris"></span>

ส่วนสำคัญในการเรียนรู้ Rust คือการอ่าน error ที่ได้จาก compiler ซึ่งจะคอยช่วยนำทางคุณสู่การเขียนที่ดี และใช้งานได้
ดังนั้นในหนังสือเล่มนี้จึงอาจมีตัวอย่างที่เมื่อนำไป run จะไม่สามารถ run ได้ เพื่อให้คุณฝึกแก้ไขปัญหาจากสถานการณ์จริง เพราะฉะนัันอย่าลืมอ่านก่อนนะว่าตัวอย่างนี้ตั้งใจให้เกิดข้อผิดพลาดหรือไม่
น้อง Ferris ก็จะช่วยคุณอีกแรงในการแยกตัวอย่างที่สามารถ run ได้ หรือ run ไม่ได้

| Ferris                                                                 | ความหมาย                                          |
|------------------------------------------------------------------------|--------------------------------------------------|
| <img src="img/ferris/does_not_compile.svg" class="ferris-explain" alt="Ferris with a question mark"/>            | code นี้ compile ไม่ได้!                      |
| <img src="img/ferris/panics.svg" class="ferris-explain" alt="Ferris throwing up their hands"/>                   | code นี้ทำให้เกิด panic!                                |
| <img src="img/ferris/not_desired_behavior.svg" class="ferris-explain" alt="Ferris with one claw up, shrugging"/> | code นี้ไม่ได้ทำงานอย่างที่ตั้งใจไว้ |

ในหลายๆครั้งเรามักจะแนะนำคุณเพื่อแก้ไข code ที่ไม่สามารถ compile ได้

## code ต้นฉบับ

code ทั้งหมดที่ใช้ในหนังสือเล่มนี้สามารถหาได้จากที่
[GitHub][book].

[book]: https://github.com/rust-lang/book/tree/main/src
